<dx:DXWindow
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
    xmlns:dxlc="http://schemas.devexpress.com/winfx/2008/xaml/layoutcontrol"
    xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
    xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm"
    xmlns:themes="http://schemas.devexpress.com/winfx/2008/xaml/core/themekeys"
    xmlns:control="clr-namespace:Core.Control;assembly=Core"
    x:Class="KursAM2.ViewModel.Period.PeriodCloseManagementView"
    Title="PeriodCloseManagementView" Height="350" Width="525">
    <dx:DXWindow.Resources>
        <!--<DataTemplate
            x:Key="{themes:FloatingContainerThemeKey ResourceKey=FloatingContainerCaptionTemplate,ThemeName=MetropolisLight}">
            <DockPanel Width="Auto" Height="24" Cursor="Arrow">
                --><!--<Image DockPanel.Dock="Right" Margin="6,0" Stretch="None" Source="../../Images/VerticalSeparator.png" />--><!--
                <TextBlock DockPanel.Dock="Right" x:Name="PART2_Text" Background="{x:Null}"
                           TextWrapping="Wrap" Margin="6,3,6,3" VerticalAlignment="Center" IsHitTestVisible="False"
                           Text="{Binding ElementName=PART6_Text, Path=Content}" FontSize="16" FontStyle="Italic"
                           FontWeight="Bold" Foreground="{Binding ElementName=PART6_Text, Path=Foreground}" />
                <TextBlock DockPanel.Dock="Right" x:Name="PART_Text" Background="{x:Null}" Foreground="#FF969696"
                           TextWrapping="Wrap" Margin="6,3,6,3" VerticalAlignment="Center" IsHitTestVisible="False"
                           Text="{Binding Path=(dx:FloatingContainer.FloatingContainer).Caption, RelativeSource={RelativeSource AncestorType=ContentPresenter}}" />
            </DockPanel>
        </DataTemplate>-->
    </dx:DXWindow.Resources>
    <DockPanel>
        <control:WndowMenu Height="60" DockPanel.Dock="Top" />
        <dxlc:LayoutControl x:Name="mainLayoutControl" DockPanel.Dock="Top">
            <dxlc:LayoutGroup View="Tabs"
                              Name="Tabs">
                <dxlc:LayoutGroup Header="Исключения" Name="Tab3">
                    <dxlc:LayoutGroup Name="Group7" dxlc:LayoutControl.AllowHorizontalSizing="True">
                        <dxg:GridControl x:Name="closedTypeGridControl5"
                                     AutoGenerateColumns="AddNew"
                                     VerticalAlignment="Stretch"
                                     EnableSmartColumnsGeneration="True"
                                     dx:DXSerializer.SerializationID="closedTypeGridControl5"
                                     dx:DXSerializer.StoreLayoutMode="All"
                                     dxg:DataControlSerializationOptions.AddNewColumns="False"
                                     dxg:DataControlSerializationOptions.RemoveOldColumns="False"
                                     CurrentItem="{Binding CurrentPeriodClosed}"
                                     ItemsSource="{Binding PeriodClosed}">
                            <dxg:GridControl.View>
                                <dxg:TableView ShowTotalSummary="True"
                                           EnableImmediatePosting="True"
                                           x:Name="closedTypeGridControlView5"
                                           ShowAutoFilterRow="True"
                                           ShowGroupPanel="False"
                                           AllowEditing="True">
                                    <dxmvvm:Interaction.Behaviors>
                                        <dxmvvm:EventToCommand EventName="CellValueChanged"
                                                               Command="{Binding SetNewClosedDateCommand}" />
                                    </dxmvvm:Interaction.Behaviors>
                                </dxg:TableView>
                            </dxg:GridControl.View>
                        </dxg:GridControl>
                    </dxlc:LayoutGroup>
                    <dxlc:LayoutGroup Name="Group8" dxlc:LayoutControl.AllowHorizontalSizing="True">
                        <dxg:GridControl x:Name="closedTypeGridControl6"
                                         AutoGenerateColumns="AddNew"
                                         VerticalAlignment="Stretch"
                                         EnableSmartColumnsGeneration="True"
                                         dx:DXSerializer.SerializationID="closedTypeGridControl6"
                                         dx:DXSerializer.StoreLayoutMode="All"
                                         dxg:DataControlSerializationOptions.AddNewColumns="False"
                                         dxg:DataControlSerializationOptions.RemoveOldColumns="False"
                                         CurrentItem="{Binding CurrentPeriodExlude}"
                                         ItemsSource="{Binding PeriodExclude}">
                            <dxg:GridControl.View>
                                <dxg:TableView ShowTotalSummary="True"
                                               EnableImmediatePosting="True"
                                               x:Name="closedTypeGridControlView6"
                                               ShowAutoFilterRow="True"
                                               ShowGroupPanel="False"
                                               AllowEditing="True">
                                    <dxmvvm:Interaction.Behaviors>
                                        <dxmvvm:EventToCommand EventName="CellValueChanged"
                                                               Command="{Binding NewPeriodExcludeCommand}" />
                                    </dxmvvm:Interaction.Behaviors>
                                </dxg:TableView>
                            </dxg:GridControl.View>
                        </dxg:GridControl>
                    </dxlc:LayoutGroup>
                </dxlc:LayoutGroup>
                <dxlc:LayoutGroup Header="Группы пользователей" Name="Tab2" Orientation="Horizontal">
                    <dxg:GridControl x:Name="closedTypeGridControl2"
                                     AutoGenerateColumns="AddNew"
                                     VerticalAlignment="Stretch"
                                     EnableSmartColumnsGeneration="True"
                                     dx:DXSerializer.SerializationID="closedTypeGridControl2"
                                     dx:DXSerializer.StoreLayoutMode="All"
                                     dxg:DataControlSerializationOptions.AddNewColumns="False"
                                     dxg:DataControlSerializationOptions.RemoveOldColumns="False"
                                     CurrentItem="{Binding CurrentGroup}"
                                     ItemsSource="{Binding PeriodGroups}">
                        <dxg:GridControl.View>
                            <dxg:TableView ShowTotalSummary="True"
                                           EnableImmediatePosting="True"
                                           x:Name="closedTypeGridControlView2"
                                           ShowAutoFilterRow="True"
                                           ShowGroupPanel="False"
                                           AllowEditing="True">
                            </dxg:TableView>
                        </dxg:GridControl.View>
                    </dxg:GridControl>
                    <dxlc:LayoutGroup Name="Tab2item2" dxlc:LayoutControl.AllowHorizontalSizing="True">
                        <dxg:GridControl x:Name="closedTypeGridControl4"
                                         AutoGenerateColumns="AddNew"
                                         VerticalAlignment="Stretch"
                                         EnableSmartColumnsGeneration="True"
                                         dx:DXSerializer.SerializationID="closedTypeGridControl4"
                                         dx:DXSerializer.StoreLayoutMode="All"
                                         dxg:DataControlSerializationOptions.AddNewColumns="False"
                                         dxg:DataControlSerializationOptions.RemoveOldColumns="False"
                                         ItemsSource="{Binding PeriodUsers}"
                                         CurrentItem="{Binding CurrentPeriodUsers}">
                            <dxg:GridControl.ContextMenu>
                                <ContextMenu>
                                    <MenuItem Header="Добавить"
                                              Command="{Binding AddNewUserCommand}"/>
                                    <MenuItem Header="Удалить"
                                              Command="{Binding DeleteUserCommand}"/>
                                </ContextMenu>
                            </dxg:GridControl.ContextMenu>
                            <dxg:GridControl.View>
                                <dxg:TableView ShowTotalSummary="True"
                                               EnableImmediatePosting="True"
                                               x:Name="closedTypeGridControlView3"
                                               ShowAutoFilterRow="True"
                                               ShowGroupPanel="False"
                                               AllowEditing="True">
                                </dxg:TableView>
                            </dxg:GridControl.View>
                        </dxg:GridControl>
                    </dxlc:LayoutGroup>
                </dxlc:LayoutGroup>
            </dxlc:LayoutGroup>
        </dxlc:LayoutControl>
        <!--<dxlc:LayoutControl x:Name="mainLayoutControl" Margin="0,10,0,0" Orientation="Vertical" Padding="0">
            <Label x:Name="PART6_Text" Visibility="Hidden" Width="0" Height="0"
               Content="{Binding DatabaseName, NotifyOnSourceUpdated=True}" Foreground="{Binding DatabaseColor}" />
            <dx:DXTabControl Name="TabControl" dx:DXSerializer.SerializationID="MainControl" Padding="0">
                <dx:DXTabItem Header="Периоды">
                    <Grid Background="Transparent">
                        <dxlc:LayoutControl x:Name="periodLayoutManager" Header="Header" Orientation="Vertical"
                                            UseLayoutRounding="True" Padding="0">
                            <dxlc:LayoutGroup Header="Группы документов" View="GroupBox"
                                              dxlc:LayoutControl.AllowVerticalSizing="True">
                                <dxg:GridControl x:Name="closedTypeGridControl"
                                                 Margin="-8"
                                                 dx:DXSerializer.SerializationID="gridPeriods"
                                                 dx:DXSerializer.StoreLayoutMode="All"
                                                 dxg:GridSerializationOptions.AddNewColumns="True"
                                                 dxg:GridSerializationOptions.RemoveOldColumns="True"
                                                 AutoGenerateColumns="None"
                                                 EnableSmartColumnsGeneration="True"
                                                 HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                                                 CurrentItem="{Binding CurrentPeriod,NotifyOnSourceUpdated=True, NotifyOnTargetUpdated=True}"
                                                 ItemsSource="{Binding PeriodClosed,NotifyOnSourceUpdated=True, NotifyOnTargetUpdated=True}"
                                                 SelectionMode="Row"
                                                 SelectedItems="{Binding SelectedItems}">
                                    <dxg:GridControl.ContextMenu>
                                        <ContextMenu>
                                            <MenuItem Header="Установить разрашение для редактирования документов"
                                                      Command="{Binding ClosePeriodSetCommand}" />
                                        </ContextMenu>
                                    </dxg:GridControl.ContextMenu>
                                    <dxg:GridControl.Columns>
                                        <dxg:GridColumn Name="closeName1_1" FieldName="TypeClosed" Header="Группа" />
                                        <dxg:GridColumn Name="closeName2" FieldName="DateClosed" Header="Дата закрытия" />
                                    </dxg:GridControl.Columns>
                                    <dxg:GridControl.View>
                                        <dxg:TableView AllowPerPixelScrolling="True" ShowTotalSummary="True">
                                            <dxmvvm:Interaction.Behaviors>
                                                <dxmvvm:EventToCommand PassEventArgsToCommand="True"
                                                                       Command="{Binding MainDataRowChangedCommand}"
                                                                       CommandParameter="{Binding ElementName=Self, Path=CurrentItem}"
                                                                       EventName="CellValueChanged" />
                                                <dxmvvm:EventToCommand PassEventArgsToCommand="True"
                                                                       Command="{Binding DataRowChangingCommand}"
                                                                       CommandParameter="{Binding ElementName=Self, Path=CurrentItem}"
                                                                       EventName="CellValueChanging" />
                                            </dxmvvm:Interaction.Behaviors>
                                        </dxg:TableView>
                                    </dxg:GridControl.View>
                                </dxg:GridControl>
                            </dxlc:LayoutGroup>
                            <dxlc:LayoutGroup Header="Исключенные группы пользователей" View="GroupBox"
                                              dxlc:LayoutControl.AllowVerticalSizing="True">
                                <dxg:GridControl x:Name="excludeGridControl"
                                                 Margin="-8"
                                                 dx:DXSerializer.SerializationID="gridExclude"
                                                 dx:DXSerializer.StoreLayoutMode="All"
                                                 dxg:GridSerializationOptions.AddNewColumns="True"
                                                 dxg:GridSerializationOptions.RemoveOldColumns="True"
                                                 AutoGenerateColumns="None"
                                                 EnableSmartColumnsGeneration="True"
                                                 CurrentItem="{Binding CurrentUserGroup}"
                                                 HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                                                 ItemsSource="{Binding Path=CurrentItem.ExcludeUserGroups,ElementName=closedTypeGridControl,NotifyOnSourceUpdated=True, NotifyOnTargetUpdated=True}"
                                                 SelectedItems="{Binding SelectedExclude}" SelectionMode="Row">
                                    <dxg:GridControl.Columns>
                                        <dxg:GridColumn Name="groupName1" FieldName="UserGroup" Header="Группа" />
                                        <dxg:GridColumn Name="dateOut1" FieldName="DateOut" Header="Действует до" />
                                        <dxg:GridColumn Name="dateFrom1" FieldName="DateFrom" Header="Дествует с" />
                                    </dxg:GridControl.Columns>
                                    <dxg:GridControl.ContextMenu>
                                        <ContextMenu>
                                            <MenuItem Header="Удалить" Command="{Binding DeleteUsersGroupsCommand}" />
                                        </ContextMenu>
                                    </dxg:GridControl.ContextMenu>
                                    <dxg:GridControl.View>
                                        <dxg:TableView AllowPerPixelScrolling="True" ShowTotalSummary="True">
                                            <dxmvvm:Interaction.Triggers>
                                                <dxmvvm:EventToCommand PassEventArgsToCommand="True"
                                                                       Command="{Binding MainDataRowChangedCommand}"
                                                                       CommandParameter="{Binding ElementName=Self, Path=CurrentItem}"
                                                                       EventName="CellValueChanged" />
                                                <dxmvvm:EventToCommand PassEventArgsToCommand="True"
                                                                       Command="{Binding DataRowChangingCommand}"
                                                                       CommandParameter="{Binding ElementName=Self, Path=CurrentItem}"
                                                                       EventName="CellValueChanging" />
                                            </dxmvvm:Interaction.Triggers>
                                        </dxg:TableView>
                                    </dxg:GridControl.View>
                                </dxg:GridControl>
                            </dxlc:LayoutGroup>
                        </dxlc:LayoutControl>
                    </Grid>
                </dx:DXTabItem>
                <dx:DXTabItem Header="Группы пользователей">
                    <dxlc:LayoutControl x:Name="userGroupLayoutControl">
                        <dxlc:LayoutGroup Orientation="Horizontal">
                            <dxlc:LayoutGroup Header="LayoutGroup" View="GroupBox"
                                              dxlc:LayoutControl.AllowHorizontalSizing="True">
                                <dxg:GridControl x:Name="userGroupGridControl"
                                                 dx:DXSerializer.SerializationID="gridUsers"
                                                 dx:DXSerializer.StoreLayoutMode="All"
                                                 dxg:GridSerializationOptions.AddNewColumns="True"
                                                 dxg:GridSerializationOptions.RemoveOldColumns="True"
                                                 AutoGenerateColumns="None"
                                                 EnableSmartColumnsGeneration="True"
                                                 HorizontalAlignment="Stretch"
                                                 VerticalAlignment="Stretch"
                                                 CurrentItem="{Binding SelectedRow,NotifyOnSourceUpdated=True, NotifyOnTargetUpdated=True}"
                                                 ItemsSource="{Binding Groups,NotifyOnSourceUpdated=True, NotifyOnTargetUpdated=True}">
                                    <dxg:GridControl.Columns>
                                        <dxg:GridColumn Name="userCol1" Header="Группы" FieldName="Name" />
                                    </dxg:GridControl.Columns>
                                    <dxg:GridControl.ContextMenu>
                                        <ContextMenu>
                                            <MenuItem Header="Создать" Command="{Binding AddGroupCommand}" />
                                            <MenuItem Header="Удалить" Command="{Binding DeleteGroupCommand}" />
                                            <Separator />
                                            <MenuItem Header="Добавить группы пользователей для выбранных"
                                                      ToolTip="Добавить группы исключенные из правил котнроля закрытого периода"
                                                      Command="{Binding AddExcludeForSelectedCommand}" />
                                            <Separator />
                                            <MenuItem Header="Сохранить" Command="{Binding SaveDataCommand}" />
                                            <MenuItem Header="Обновить" Command="{Binding RefreshDataCommand}" />
                                        </ContextMenu>
                                    </dxg:GridControl.ContextMenu>
                                    <dxg:GridControl.View>
                                        <dxg:TableView ShowTotalSummary="True">
                                            <dxmvvm:Interaction.Triggers>
                                                <dxmvvm:EventToCommand PassEventArgsToCommand="True"
                                                                       Command="{Binding MainDataRowChangedCommand}"
                                                                       CommandParameter="{Binding ElementName=Self, Path=CurrentItem}"
                                                                       EventName="CellValueChanged" />
                                                <dxmvvm:EventToCommand PassEventArgsToCommand="True"
                                                                       Command="{Binding DataRowChangingCommand2}"
                                                                       CommandParameter="{Binding ElementName=Self, Path=CurrentItem}"
                                                                       EventName="CellValueChanging" />
                                            </dxmvvm:Interaction.Triggers>
                                        </dxg:TableView>
                                    </dxg:GridControl.View>
                                </dxg:GridControl>
                            </dxlc:LayoutGroup>
                            <dxlc:LayoutGroup Header="LayoutGroup" View="GroupBox"
                                              dxlc:LayoutControl.AllowHorizontalSizing="True">
                                <dxg:GridControl x:Name="userListGridControl" SelectionMode="Row"
                                                 dx:DXSerializer.SerializationID="gridDocs"
                                                 dx:DXSerializer.StoreLayoutMode="All"
                                                 dxg:GridSerializationOptions.AddNewColumns="False"
                                                 dxg:GridSerializationOptions.RemoveOldColumns="False"
                                                 AutoGenerateColumns="AddNew"
                                                 EnableSmartColumnsGeneration="True"
                                                 HorizontalAlignment="Stretch"
                                                 VerticalAlignment="Stretch"
                                                 SelectedItems="{Binding SelectedUsers}"
                                                 ItemsSource="{Binding CurrentItem.Users, ElementName=userGroupGridControl,NotifyOnSourceUpdated=True, NotifyOnTargetUpdated=True}">
                                    <dxg:GridControl.ContextMenu>
                                        <ContextMenu>
                                            <MenuItem Header="Добавить" Command="{Binding AddUserCommand}" />
                                            <MenuItem Header="Удалить" Command="{Binding DeleteUserCommand }" />
                                        </ContextMenu>
                                    </dxg:GridControl.ContextMenu>
                                    <dxg:GridControl.View>
                                        <dxg:TableView AllowPerPixelScrolling="True" ShowTotalSummary="True">
                                            <dxmvvm:Interaction.Triggers>
                                                <dxmvvm:EventToCommand PassEventArgsToCommand="True"
                                                                       Command="{Binding MainDataRowChangedCommand}"
                                                                       CommandParameter="{Binding ElementName=Self, Path=CurrentItem}"
                                                                       EventName="CellValueChanged" />
                                                <dxmvvm:EventToCommand PassEventArgsToCommand="True"
                                                                       Command="{Binding DataRowChangingCommand}"
                                                                       CommandParameter="{Binding ElementName=Self, Path=CurrentItem}"
                                                                       EventName="CellValueChanging" />
                                            </dxmvvm:Interaction.Triggers>
                                        </dxg:TableView>
                                    </dxg:GridControl.View>
                                </dxg:GridControl>
                            </dxlc:LayoutGroup>
                        </dxlc:LayoutGroup>
                    </dxlc:LayoutControl>
                </dx:DXTabItem>
            </dx:DXTabControl>
        </dxlc:LayoutControl>-->
    </DockPanel>
</dx:DXWindow>