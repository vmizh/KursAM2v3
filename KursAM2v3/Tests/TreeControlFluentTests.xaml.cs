using System;
using System.Collections.ObjectModel;
using System.Windows;
using Core;
using Core.Helper;
using Core.ViewModel.Base;
using Core.ViewModel.Common;
using DevExpress.Xpf.Grid;
using KursAM2.View.Management;
using KursAM2.ViewModel.Period;
using LayoutManager;

namespace KursAM2.Tests
{
    /// <summary>
    ///     Interaction logic for TreeControlFluentTests.xaml
    /// </summary>
    public partial class TreeControlFluentTests : ILayout
    {
        public TreeControlFluentTests()
        {
            InitializeComponent();
        }

        public LayoutManager.LayoutManager LayoutManager { get; set; }
        public string LayoutManagerName { get; set; }
        public void ResetLayot()
        {
            throw new NotImplementedException();
        }

        private void GridProjects_OnAutoGeneratingColumn(object sender, AutoGeneratingColumnEventArgs e)
        {
        }

        private void GridProjects_OnAutoGeneratedColumns(object sender, RoutedEventArgs e)
        {
        }

        private void ButtonBase_OnClick(object sender, RoutedEventArgs e)
        {
            var dtx = DataContext as TestContext;
            dtx?.RefreshData(null);
        }
    }


    public class TestContext : RSWindowViewModelBase
    {
        private Project myCurrentPeriod;
        public ObservableCollection<Project> Periods { set; get; } =
            new ObservableCollection<Project>();
        public Project CurrentPeriod
        {
            get => myCurrentPeriod;
            set
            {
                if (myCurrentPeriod != null && myCurrentPeriod.Equals(value)) return;
                myCurrentPeriod = value;
                if (myCurrentPeriod == null) return;
                // ReSharper disable once UnusedVariable
                var frm = Form as ProjectsView;
                RaisePropertyChanged();
            }
        }

        public TestContext()
        {
           Periods.Add(new Project());
         
        }

        public override void RefreshData(object obj)
        {
            base.RefreshData(obj);
            Periods.Clear();
        }
    }
}